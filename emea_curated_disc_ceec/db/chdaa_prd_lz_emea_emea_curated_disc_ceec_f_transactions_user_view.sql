CREATE TABLE chdaa_prd_lz_emea.emea_curated_disc_ceec.f_transactions_user_view (
  DATA_DELIVERY_DATE DATE,
  KPI STRING,
  Kamsoft_program_name STRING,
  Kamsoft_program_ID STRING,
  Date_purchase DATE,
  Expiry_date DATE,
  Batch_number STRING,
  Distributor STRING,
  Sales_type STRING,
  Document_ID STRING,
  Order_ID STRING,
  Sales_time STRING,
  Purchase_type STRING,
  Date_distributor_sales DATE,
  Discount_packet STRING,
  Date_start_discount_packet DATE,
  Date_end_discount_packet DATE,
  Date_order_forward DATE,
  Chain_order_ID STRING,
  Chain_Customer_name STRING,
  Order_status STRING,
  Rep_comments STRING,
  Distributor_comments STRING,
  Internal_comments STRING,
  Product_objections STRING,
  Additional_info STRING,
  TRANSACTION_SOURCE STRING,
  transaction_time_time_id TIMESTAMP,
  transaction_customer_customer_id STRING,
  TRANSACTION_CUSTOMER_BK BIGINT,
  transaction_product_product_id STRING,
  TRANSACTION_PRODUCT_BK STRING,
  PSDT_AKT_SYNCH TIMESTAMP,
  Volume DECIMAL(18,2),
  sell_in_volume_before_correction DECIMAL(18,2),
  Discount_percentage DECIMAL(18,2),
  ExFactory_price_1 DECIMAL(18,2),
  Estimated_compensation_value DECIMAL(18,2),
  Estimated_order_value_exfactory_price DECIMAL(18,2),
  Estimated_order_value_ex_factory_price_after_compensation DECIMAL(18,2),
  Date_corrected DATE,
  adress STRING,
  area_commercial STRING,
  area_education STRING,
  attributes STRING,
  behind_counter_exposition STRING,
  behind_glass_exposition STRING,
  chain_customer_account STRING,
  chain_type STRING,
  city STRING,
  commercial_segment STRING,
  contract STRING,
  customer_bk STRING,
  customer_change_timestamp TIMESTAMP,
  customer_group STRING,
  customer_id STRING,
  customer_is_valid BOOLEAN,
  customer_lad STRING,
  customer_source STRING,
  customer_valid_from TIMESTAMP,
  customer_valid_to TIMESTAMP,
  dnv_commercial STRING,
  dnv_education STRING,
  education_segment STRING,
  email STRING,
  external_source STRING,
  group_owner STRING,
  group_type STRING,
  id_acres STRING,
  id_chain_customer STRING,
  id_customer STRING,
  id_esalesweb STRING,
  id_external_reporting STRING,
  id_farmaprom STRING,
  importance STRING,
  iqvia_brick STRING,
  is_dermatological STRING,
  is_kamsoft STRING,
  is_ordering STRING,
  is_self_service STRING,
  kamsoft_agreement STRING,
  last_visit_commercial DATE,
  last_visit_education DATE,
  name_chain_customer STRING,
  nip STRING,
  pharmacy_name STRING,
  pharmacy_status STRING,
  pharmacy_type STRING,
  phone_number STRING,
  position STRING,
  rep_id_commercial STRING,
  rep_id_education STRING,
  rep_name_commercial STRING,
  rep_name_education STRING,
  store_window STRING,
  zip_code STRING,
  active_substance_dosage STRING,
  aktualnosc DATE,
  attribute STRING,
  bazyl STRING,
  bloz7 STRING,
  brand STRING,
  brand_group STRING,
  category STRING,
  ean STRING,
  exfactory_price DECIMAL(18,2),
  fct_tool_name STRING,
  form STRING,
  is_commercial STRING,
  is_contracted STRING,
  is_massmarket STRING,
  is_msl_list STRING,
  key_words STRING,
  nr_pozwolenia STRING,
  pkwiu STRING,
  product_bk STRING,
  product_id STRING,
  product_is_valid STRING,
  product_type STRING,
  product_valid_from TIMESTAMP,
  product_valid_to TIMESTAMP,
  sap_id STRING,
  sap_name STRING,
  sku_name STRING,
  sku_short_name STRING,
  status STRING,
  unit_of_measurement STRING,
  units_volume STRING,
  vat DECIMAL(18,2),
  product_source STRING,
  cur_adress STRING,
  cur_area_commercial STRING,
  cur_area_education STRING,
  cur_attributes STRING,
  cur_behind_counter_exposition STRING,
  cur_behind_glass_exposition STRING,
  cur_chain_customer_account STRING,
  cur_chain_type STRING,
  cur_city STRING,
  cur_commercial_segment STRING,
  cur_contract STRING,
  cur_customer_bk STRING,
  cur_customer_change_timestamp TIMESTAMP,
  cur_customer_group STRING,
  cur_customer_id STRING,
  cur_customer_is_valid BOOLEAN,
  cur_customer_lad STRING,
  cur_customer_source STRING,
  cur_customer_valid_from TIMESTAMP,
  cur_customer_valid_to TIMESTAMP,
  cur_dnv_commercial STRING,
  cur_dnv_education STRING,
  cur_education_segment STRING,
  cur_email STRING,
  cur_external_source STRING,
  cur_group_owner STRING,
  cur_group_type STRING,
  cur_id_acres STRING,
  cur_id_chain_customer STRING,
  cur_id_customer STRING,
  cur_id_esalesweb STRING,
  cur_id_external_reporting STRING,
  cur_id_farmaprom STRING,
  cur_importance STRING,
  cur_iqvia_brick STRING,
  cur_is_dermatological STRING,
  cur_is_kamsoft STRING,
  cur_is_ordering STRING,
  cur_is_self_service STRING,
  cur_kamsoft_agreement STRING,
  cur_last_visit_commercial DATE,
  cur_last_visit_education DATE,
  cur_name_chain_customer STRING,
  cur_nip STRING,
  cur_pharmacy_name STRING,
  cur_pharmacy_status STRING,
  cur_pharmacy_type STRING,
  cur_phone_number STRING,
  cur_position STRING,
  cur_rep_id_commercial STRING,
  cur_rep_id_education STRING,
  cur_rep_name_commercial STRING,
  cur_rep_name_education STRING,
  cur_store_window STRING,
  cur_zip_code STRING,
  rep_email_commercial STRING,
  rep_email_commercial_2 STRING,
  time_id DATE,
  year INT,
  quarter INT,
  month INT,
  week_of_year INT,
  day_of_year INT,
  day_of_month INT,
  day_of_week INT,
  year_quarter STRING,
  year_month STRING,
  f_transaction_key STRING,
  ETLLastModifiedDate TIMESTAMP)
USING delta
PARTITIONED BY (TRANSACTION_SOURCE, year_month)
LOCATION 'abfss://curated@zpdatacoresadpemea.dfs.core.windows.net/discovery/ceec/f_transactions_user_view'
TBLPROPERTIES (
  'delta.checkpoint.writeStatsAsJson' = 'false',
  'delta.checkpoint.writeStatsAsStruct' = 'true',
  'delta.deletedFileRetentionDuration' = 'interval 7 days',
  'delta.enableDeletionVectors' = 'true',
  'delta.feature.deletionVectors' = 'supported',
  'delta.logRetentionDuration' = 'interval 7 days',
  'delta.minReaderVersion' = '3',
  'delta.minWriterVersion' = '7')