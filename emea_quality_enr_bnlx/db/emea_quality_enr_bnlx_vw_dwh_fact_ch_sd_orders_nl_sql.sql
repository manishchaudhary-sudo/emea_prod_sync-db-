CREATE VIEW emea_quality_enr_bnlx.vw_dwh_fact_ch_sd_orders_nl_sql (
  `0doc_number`,
  `0s_ord_item`,
  `0dsdel_date`,
  sapsdreqdeldate,
  `0soursystem`,
  derdato,
  sapsdoicredate,
  `0lst_a_dd`,
  daedato,
  sapsdoichgdate,
  derdatoh,
  sapsdohcredate,
  `0doc_date`,
  sapsddocdate,
  divestsna,
  `0logsys`,
  `0sched_line`,
  `0overall_st`,
  `0dlv_sts`,
  `0ship_cond`,
  dorqtybu,
  `0cml_cf_qty`,
  `0net_value`,
  dnetvallc,
  `0net_price`,
  `0subtotal_1`,
  `0so_i_cnt`,
  `0comp_code`,
  `0salesorg`,
  `0material`,
  `0sold_to`,
  `0doc_type`,
  `0reason_rej`,
  dflsta,
  dfksta,
  `0payer`,
  `0fiscper`,
  `0gt_bsarksd`,
  `0ship_to`,
  `0billtoprty`,
  `0plant`,
  rls_auth_sid,
  `0material___t`,
  `0matl_type`,
  `0matl_type___t`,
  `0base_uom`,
  `0base_uom___t`,
  dprodh1,
  dprodh1___t,
  dprodh2,
  dprodh2___t,
  dprodh3,
  dprodh3___t,
  dprodh4,
  dprodh4___t,
  dprodh5,
  dprodh5___t,
  dprodh6,
  dprodh6___t,
  dbrand,
  dbrand___t,
  division,
  division___t,
  dbrandf,
  dbrandf___t,
  `0prodh6`,
  `0prodh6___t`,
  dan_cog,
  dan_cog___t,
  `0eanupc`,
  d_fgps,
  d_fgpsu,
  d_cbpck,
  d_cpckd,
  d_pptyp,
  d_trian,
  d_prsite,
  d_pasite,
  dlp_form,
  dlp_form__t,
  d_lcpha,
  `0extmatlgrp`,
  d_gtin1,
  d_gtin1c,
  d_gtin1u,
  d_gtin2,
  d_gtin2c,
  d_gtin2u,
  `0matl_group`,
  d_raube,
  d_gtin1c___t,
  d_gtin1u___t,
  d_gtin2c___t,
  d_gtin2u___t,
  d_raube___t,
  d_uvp,
  `0del_flag`,
  `0sapmaterial_code_trim`,
  product_brand,
  product_brand_cluster,
  product_category,
  product_cnk_material_code,
  product_cnk_material_name,
  product_country_code,
  product_iri_ean_code,
  product_iri_material_name,
  main_sap_material_code,
  product_portfolio_management,
  product_name,
  product_status,
  product_sub_brand,
  `0country___t_billto`,
  `0street_billto`,
  `0country_billto`,
  `0customer___t_billto`,
  `0customer_billto_trim`,
  `0postal_cd_billto`,
  `0customer_billto`,
  `0city_billto`,
  `0country___t_payer`,
  `0customer___t_payer`,
  `0customer_payer`,
  `0city_payer`,
  `0postal_cd_payer`,
  `0street_payer`,
  `0country_payer`,
  `0customer_payer_trim`,
  `0country_shipto`,
  `0customer___t_shipto`,
  `0customer_shipto_trim`,
  `0customer_shipto`,
  `0postal_cd_shipto`,
  `0country___t_shipto`,
  `0city_shipto`,
  `0street_shipto`,
  status,
  sap_apb_code,
  organization,
  main_sap_customer_code_1,
  employee_name,
  employee_cwid,
  d_customer_mapping_code,
  country_code,
  cluster,
  channel,
  `0country_soldto`,
  `0country___t_soldto`,
  `0postal_cd_soldto`,
  `0street_soldto`,
  `0city_soldto`,
  `0customer_soldto`,
  `0customer___t_soldto`,
  `0customer_soldto_trim`,
  dcgrp,
  `0company`,
  `0company___t`,
  `0country`,
  `0currency`,
  `0comp_code___t`,
  `0salesorg___t`)
WITH SCHEMA BINDING
AS (
  
Select fact.0doc_number,fact.0s_ord_item,fact.0dsdel_date, CASE fact.0dsdel_date WHEN '00000000' then null ELSE  fact.0dsdel_date END AS sapsdreqdeldate, fact.0soursystem,
fact.derdato, fact.derdato AS sapsdoicredate,fact.0lst_a_dd,fact.daedato,CASE fact.daedato WHEN '00000000' then null ELSE  fact.daedato END AS sapsdoichgdate
,fact.derdatoh,fact.derdatoh AS sapsdohcredate,fact.0doc_date, fact.0doc_date AS sapsddocdate,fact.divestsna,fact.0logsys,
fact.0sched_line,fact.0overall_st,fact.0dlv_sts,fact.0ship_cond,fact.dorqtybu,fact.0cml_cf_qty,fact.0net_value,fact.dnetvallc,fact.0net_price,fact.0subtotal_1,fact.0so_i_cnt,fact.0comp_code,fact.0salesorg,fact.0material,fact.0sold_to,fact.0doc_type,fact.0reason_rej,fact.dflsta,fact.dfksta,fact.0payer,
fact.0fiscper,fact.0gt_bsarksd,fact.0ship_to,fact.0billtoprty,fact.0plant,fact.rls_auth_sid,
prodnl.0material___t,prodnl.0matl_type,prodnl.0matl_type___t,prodnl.0base_uom,prodnl.0base_uom___t,prodnl.dprodh1,prodnl.dprodh1___t,prodnl.dprodh2,
prodnl.dprodh2___t,prodnl.dprodh3,prodnl.dprodh3___t,prodnl.dprodh4,prodnl.dprodh4___t,prodnl.dprodh5,prodnl.dprodh5___t,prodnl.dprodh6,prodnl.dprodh6___t,prodnl.dbrand,
prodnl.dbrand___t,prodnl.division,prodnl.division___t,prodnl.dbrandf,prodnl.dbrandf___t,prodnl.0prodh6,prodnl.0prodh6___t,prodnl.dan_cog,prodnl.dan_cog___t,prodnl.0eanupc,
prodnl.d_fgps,prodnl.d_fgpsu,prodnl.d_cbpck,prodnl.d_cpckd,prodnl.d_pptyp,prodnl.d_trian,prodnl.d_prsite,prodnl.d_pasite,prodnl.dlp_form,prodnl.dlp_form__t,prodnl.d_lcpha,
prodnl.0extmatlgrp,prodnl.d_gtin1,prodnl.d_gtin1c,prodnl.d_gtin1u,prodnl.d_gtin2,prodnl.d_gtin2c,prodnl.d_gtin2u,prodnl.0matl_group,prodnl.d_raube,prodnl.d_gtin1c___t,
prodnl.d_gtin1u___t,prodnl.d_gtin2c___t,prodnl.d_gtin2u___t,prodnl.d_raube___t,prodnl.d_uvp,prodnl.0del_flag,prodnl.0sapmaterial_code_trim,prodnl.product_brand,
prodnl.product_brand_cluster,prodnl.product_category,prodnl.product_cnk_material_code,prodnl.product_cnk_material_name,prodnl.product_country_code,prodnl.product_iri_ean_code,
prodnl.product_iri_material_name,prodnl.main_sap_material_code,prodnl.product_portfolio_management,prodnl.product_name,prodnl.product_status,prodnl.product_sub_brand,
billto.0country___t_billto,billto.0street_billto,billto.0country_billto,billto.0customer___t_billto,billto.0customer_billto_trim,billto.0postal_cd_billto,billto.0customer_billto,billto.0city_billto,payer.0country___t_payer,payer.0customer___t_payer,payer.0customer_payer,payer.0city_payer,payer.0postal_cd_payer,payer.0street_payer,payer.0country_payer,payer.0customer_payer_trim,shipto.0country_shipto,shipto.0customer___t_shipto,shipto.0customer_shipto_trim,shipto.0customer_shipto,
shipto.0postal_cd_shipto,shipto.0country___t_shipto,shipto.0city_shipto,shipto.0street_shipto,custsold.status,custsold.sap_apb_code,custsold.organization,custsold.main_sap_customer_code_1,custsold.employee_name,custsold.employee_cwid,custsold.d_customer_mapping_code,custsold.country_code,custsold.cluster,custsold.channel,custsold.0country_soldto,custsold.0country___t_soldto,custsold.0postal_cd_soldto,custsold.0street_soldto,custsold.0city_soldto,custsold.0customer_soldto,custsold.0customer___t_soldto,custsold.0customer_soldto_trim,compc.dcgrp,compc.0company,compc.0company___t,compc.0country,compc.0currency,compc.0comp_code___t,
saleorg.0salesorg___t

 from emea_quality_enr_bnlx.prep_fact_sap_sd_orders_nl_remove_prod fact
left join emea_quality_enr_bnlx.dim_prepare_ch_product_dimension_nl prodnl on fact.0material=prodnl.0material
left join emea_quality_enr_bnlx.dim_customer_p_001_billto billto on fact.0billtoprty=billto.0country_billto
left join emea_quality_enr_bnlx.dim_customer_p_001_payer payer on fact.0payer=payer.0customer_payer
left join emea_quality_enr_bnlx.dim_customer_p_001_shipto shipto on fact.0ship_to=shipto.0customer_shipto
left join emea_quality_enr_bnlx.dim_prepare_sd_cust_soldto_dimension_nl custsold on fact.0sold_to=custsold.0customer_soldto
left join emea_quality_enr_bnlx.dim_comp_code_p_001 compc on fact.0comp_code=compc.0comp_code
left join emea_quality_enr_bnlx.dim_salesorg_p_001 saleorg on fact.0salesorg=saleorg.0salesorg
)